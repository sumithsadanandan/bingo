<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sumithâ€™s Bingo</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap" rel="stylesheet">

<style>
:root {
  --bg: linear-gradient(135deg, #fde2e4, #fadadd);
  --card: #ffffff;
  --cell: #ffffff;
  --border: #e8e8e8;
  --marked: #e6dbff;   /* lavender */
  --complete: #c8f7dc; /* green */
  --accent: #f48fb1;
  --accent-dark: #ec407a;
  --text: #444;
  --shadow: 0 12px 30px rgba(0,0,0,0.08);
}

body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: var(--bg);
  min-height: 100vh;
  display: flex;
  justify-content: center;
}

.app {
  width: 100%;
  max-width: 420px;
  padding: 16px;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

h1 {
  margin: 6px 0;
  color: var(--text);
}

/* Bingo Letters */
.bingo {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 12px 0;
}

.letter {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid var(--accent);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  color: var(--accent);
}

.letter.active {
  background: linear-gradient(135deg, var(--accent), var(--accent-dark));
  color: #fff;
}

/* Card & Grid */
.card {
  background: var(--card);
  border-radius: 20px;
  padding: 14px;
  box-shadow: var(--shadow);
}

.grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
}

.cell {
  aspect-ratio: 1;
  background: var(--cell);
  border-radius: 14px;
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 600;
  color: var(--text);
  cursor: pointer;
  transition: 0.25s;
}

.cell:active { transform: scale(0.95); }

.cell.marked {
  background: var(--marked);
}

.cell.completed {
  background: var(--complete);
}

/* Controls */
.controls {
  text-align: center;
  margin-top: 14px;
}

button {
  padding: 12px 24px;
  font-size: 16px;
  border-radius: 30px;
  border: none;
  background: linear-gradient(135deg, var(--accent), var(--accent-dark));
  color: #fff;
  cursor: pointer;
}

#bingoMessage {
  margin-top: 12px;
  font-size: 26px;
  font-weight: 600;
  color: var(--accent-dark);
  opacity: 0;
  transition: 0.6s;
}

#bingoMessage.show {
  opacity: 1;
}

canvas {
  position: fixed;
  inset: 0;
  pointer-events: none;
}
</style>
</head>

<body>
<div class="app">
  <header>
    <h1>Sumithâ€™s Bingo</h1>
  </header>

  <div class="bingo">
    <div class="letter" id="b">B</div>
    <div class="letter" id="i">I</div>
    <div class="letter" id="n">N</div>
    <div class="letter" id="g">G</div>
    <div class="letter" id="o">O</div>
  </div>

  <div class="card">
    <div class="grid" id="grid"></div>
  </div>

  <div class="controls">
    <button onclick="generateBoard()">New Board</button>
    <div id="bingoMessage">ðŸŽ‰ BINGO! ðŸŽ‰</div>
  </div>
</div>

<audio id="sound" src="sound-effect-bingo-122339.mp3"></audio>
<canvas id="confetti"></canvas>

<script>
const SIZE = 5;
let cells = [];
let completed = new Set();
let bingo = false;
let audioReady = false;

/* CONFETTI FIX */
let confettiFrameId = null;

const sound = document.getElementById('sound');
sound.volume = 1;

/* Generate Board */
function generateBoard(){
  stopConfetti(); // âœ… clear any existing confetti

  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  cells = [];
  completed.clear();
  bingo = false;

  document.getElementById('bingoMessage').classList.remove('show');
  document.querySelectorAll('.letter').forEach(l => l.classList.remove('active'));

  const nums = [...Array(25).keys()].map(i => i + 1).sort(() => Math.random() - 0.5);

  nums.forEach(n => {
    const cell = document.createElement('div');
    cell.className = 'cell';
    cell.textContent = n;

    cell.onclick = () => {
      if(!audioReady){
        sound.play().catch(()=>{});
        sound.pause();
        audioReady = true;
      }
      cell.classList.toggle('marked');
      checkBingo();
    };

    cells.push(cell);
    grid.appendChild(cell);
  });
}

/* Check Bingo */
function checkBingo(){
  const lines = [];

  for(let r=0;r<SIZE;r++)
    lines.push([...Array(SIZE)].map((_,c)=>r*SIZE+c));

  for(let c=0;c<SIZE;c++)
    lines.push([...Array(SIZE)].map((_,r)=>r*SIZE+c));

  lines.forEach((line, i) => {
    if(line.every(idx => cells[idx].classList.contains('marked'))){
      line.forEach(idx => cells[idx].classList.add('completed'));
      completed.add(i);
    }
  });

  ['b','i','n','g','o'].forEach((id,i)=>{
    document.getElementById(id).classList.toggle('active', completed.size > i);
  });

  if(completed.size >= 5 && !bingo){
    bingo = true;
    document.getElementById('bingoMessage').classList.add('show');
    sound.currentTime = 0;
    sound.play().catch(()=>{});
    confetti();
  }
}

/* CONFETTI (FIXED) */
function confetti(){
  const c = document.getElementById('confetti');
  const ctx = c.getContext('2d');
  c.width = innerWidth;
  c.height = innerHeight;

  const pieces = Array.from({length:120}, () => ({
    x: Math.random()*c.width,
    y: -20,
    r: Math.random()*6 + 4,
    v: Math.random()*3 + 2,
    col: ['#f48fb1','#ce93d8','#b39ddb','#80cbc4','#a5d6a7']
          [Math.floor(Math.random()*5)]
  }));

  let frame = 0;

  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    pieces.forEach(p=>{
      p.y += p.v;
      ctx.fillStyle = p.col;
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fill();
    });

    if(frame++ < 180){
      confettiFrameId = requestAnimationFrame(draw);
    } else {
      stopConfetti();
    }
  }

  draw();
}

function stopConfetti(){
  const c = document.getElementById('confetti');
  const ctx = c.getContext('2d');

  if(confettiFrameId){
    cancelAnimationFrame(confettiFrameId);
    confettiFrameId = null;
  }
  ctx.clearRect(0,0,c.width,c.height);
}

generateBoard();
</script>
</body>
</html>
